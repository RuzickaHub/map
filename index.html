<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tree Diagram</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: #0a0a0a;
            color: #f4f4f5;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .tree-container {
            position: relative;
            width: 100%;
            max-width: 900px;
        }

        .tree-node {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .node-button {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            border-radius: 16px;
            font-weight: 500;
            transition: all 0.3s ease-out;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            color: #f4f4f5;
            cursor: pointer;
            z-index: 1;
            position: relative;
        }

        .node-button:hover {
            background: rgba(255, 255, 255, 0.08);
            border-color: rgba(255, 255, 255, 0.15);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
        }

        .node-button:active {
            transform: scale(0.95);
        }

        .node-button.level-0 {
            font-size: 1.125rem;
            font-weight: 600;
        }

        .node-button.level-1, .node-button.level-2 {
            font-size: 0.875rem;
        }

        .node-children {
            display: flex;
            flex-direction: column;
            gap: 16px;
            transition: all 0.5s ease-out;
        }

        .branch {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .chevron {
            width: 16px;
            height: 16px;
            transition: transform 0.3s, color 0.3s;
            color: #a1a1aa;
        }

        .node-button:hover .chevron {
            color: #d4d4d8;
        }

        .connections {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: visible;
            z-index: 0;
        }

        .connection {
            stroke: rgb(63, 63, 70);
            stroke-width: 1.5;
            fill: none;
            transition: opacity 0.5s;
        }
    </style>
</head>
<body>
    <div class="tree-container">
        <svg class="connections" id="connections"></svg>
        
        <div class="tree-node">
            <button class="node-button level-0" data-id="root">
                <svg class="chevron chevron-down" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
                Root
            </button>
            
            <div class="node-children">
                <div class="branch">
                    <button class="node-button level-1" data-id="node1">
                        <svg class="chevron chevron-down" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                        Node 1
                    </button>
                    
                    <div class="node-children">
                        <button class="node-button level-2" data-id="node11">Node 1.1</button>
                        <button class="node-button level-2" data-id="node12">Node 1.2</button>
                    </div>
                </div>
                
                <div class="branch">
                    <button class="node-button level-1" data-id="node2">
                        <svg class="chevron chevron-down" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6 9 12 15 18 9"></polyline>
                        </svg>
                        Node 2
                    </button>
                    
                    <div class="node-children">
                        <button class="node-button level-2" data-id="node21">Node 2.1</button>
                        <button class="node-button level-2" data-id="node22">Node 2.2</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tree state management
        const treeState = {
            root: true,
            node1: true,
            node2: true
        };

        // DOM elements
        const treeContainer = document.querySelector('.tree-container');
        const connectionsSvg = document.getElementById('connections');
        
        // Node references
        const nodeRefs = {
            root: document.querySelector('[data-id="root"]'),
            node1: document.querySelector('[data-id="node1"]'),
            node2: document.querySelector('[data-id="node2"]'),
            node11: document.querySelector('[data-id="node11"]'),
            node12: document.querySelector('[data-id="node12"]'),
            node21: document.querySelector('[data-id="node21"]'),
            node22: document.querySelector('[data-id="node22"]')
        };

        // Toggle node expansion
        function toggleNode(nodeId) {
            const node = nodeRefs[nodeId];
            if (!node) return;
            
            // Toggle state
            treeState[nodeId] = !treeState[nodeId];
            
            // Update UI
            updateNodeUI(node, nodeId);
            
            // Update connection lines
            updateConnections();
        }

        // Update node UI based on state
        function updateNodeUI(node, nodeId) {
            const chevron = node.querySelector('.chevron');
            const childrenContainer = node.parentElement.querySelector('.node-children');
            
            if (treeState[nodeId]) {
                // Expanded state
                if (chevron) {
                    chevron.classList.remove('chevron-right');
                    chevron.classList.add('chevron-down');
                    chevron.innerHTML = '<polyline points="6 9 12 15 18 9"></polyline>';
                }
                if (childrenContainer) {
                    childrenContainer.style.display = 'flex';
                }
            } else {
                // Collapsed state
                if (chevron) {
                    chevron.classList.remove('chevron-down');
                    chevron.classList.add('chevron-right');
                    chevron.innerHTML = '<polyline points="9 18 15 12 9 6"></polyline>';
                }
                if (childrenContainer) {
                    childrenContainer.style.display = 'none';
                }
            }
        }

        // Get node position for connection lines
        function getNodePosition(node) {
            if (!node) return null;
            
            const rect = node.getBoundingClientRect();
            const containerRect = treeContainer.getBoundingClientRect();
            
            return {
                x: rect.left - containerRect.left + rect.width / 2,
                y: rect.top - containerRect.top + rect.height / 2,
                right: rect.right - containerRect.left,
                left: rect.left - containerRect.left,
                width: rect.width,
                height: rect.height
            };
        }

        // Draw connection line between two nodes
        function drawConnection(startId, endId, isVisible) {
            const startPos = getNodePosition(nodeRefs[startId]);
            const endPos = getNodePosition(nodeRefs[endId]);
            
            if (!startPos || !endPos || !isVisible) {
                return '';
            }
            
            // Start from right side of parent button
            const x1 = startPos.right;
            const y1 = startPos.y;
            
            // End at left side of child button
            const x2 = endPos.left;
            const y2 = endPos.y;
            
            // Control point for smooth curve
            const midX = x1 + (x2 - x1) / 2;
            
            // Create smooth bezier curve from right side to left side
            return `
                <path d="M ${x1} ${y1} C ${midX} ${y1}, ${midX} ${y2}, ${x2} ${y2}" 
                      class="connection" 
                      opacity="${isVisible ? 1 : 0}" />
            `;
        }

        // Update all connection lines
        function updateConnections() {
            const connections = [
                drawConnection('root', 'node1', treeState.root),
                drawConnection('root', 'node2', treeState.root),
                drawConnection('node1', 'node11', treeState.root && treeState.node1),
                drawConnection('node1', 'node12', treeState.root && treeState.node1),
                drawConnection('node2', 'node21', treeState.root && treeState.node2),
                drawConnection('node2', 'node22', treeState.root && treeState.node2)
            ].join('');
            
            connectionsSvg.innerHTML = connections;
        }

        // Initialize the tree
        function initTree() {
            // Set up event listeners for all nodes
            Object.keys(nodeRefs).forEach(nodeId => {
                const node = nodeRefs[nodeId];
                if (node) {
                    // Only add click listeners to nodes that have children
                    const hasChildren = node.querySelector('.chevron') !== null;
                    if (hasChildren) {
                        node.addEventListener('click', () => toggleNode(nodeId));
                    }
                    
                    // Initialize UI state
                    updateNodeUI(node, nodeId);
                }
            });
            
            // Initial connection lines
            updateConnections();
            
            // Update on window resize
            window.addEventListener('resize', updateConnections);
        }

        // Start the application
        document.addEventListener('DOMContentLoaded', initTree);
    </script>
</body>
</html>
